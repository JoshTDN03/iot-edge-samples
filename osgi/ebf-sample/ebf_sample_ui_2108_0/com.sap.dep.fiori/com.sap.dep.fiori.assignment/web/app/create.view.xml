<mvc:View controllerName="dep.fiori.assignment.app.create"
    class="dep-fiori" displayBlock="true" height="100%"
    xmlns:mvc="sap.ui.core.mvc" xmlns:u="sap.uxap" xmlns:l="sap.ui.layout"
    xmlns:f="sap.ui.layout.form" xmlns:c="sap.ui.core" xmlns="sap.m">
    <Page
        showHeader="false"
        showSubHeader="false"
        enableScrolling="false">
        <f:Form id="form">
            <f:layout>
                <f:ResponsiveGridLayout labelSpanL="2" />
            </f:layout>
            <f:toolbar>
                <Toolbar>
                    <Title text="{i18n>Create.title}" />
                    <ToolbarSpacer></ToolbarSpacer>
                    <Label text="{i18nGlobal>General.createdBy}:" />
                    <Image height="2.5rem" width="auto"
                        src="{createdByImg>/imageURL}" class="borderRadiusCircle"
                        visible="{= !!${createdByImg>/imageURL} }" />
                    <Label text="{createdByImg>/name}"
                        visible="{= !${createdByImg>/imageURL} }" />
                </Toolbar>
            </f:toolbar>
            <f:FormContainer>
                <f:layoutData>
                    <l:GridData span="L12 M12 S12" />
                </f:layoutData>
                
                <f:FormElement>
                    <f:label>
                        <Label 
                            text="{i18n>Assignment.type}"
                            required="true">
                            <layoutData>
                                <l:GridData span="L2 M3 S12" />
                            </layoutData>
                        </Label>
                    </f:label>
                    <Select
                        id="typeSelect"
                        items="{odata>/Assignment_Type}"
                        selectedKey="{/OBJTYPE}"
                        change="onTypeChange">
                        <c:Item text="{odata>TEXT}" key="{odata>TYPE}" />
                        <layoutData>
                            <l:GridData span="L3 M4 S12" />
                        </layoutData>
                    </Select>
                </f:FormElement>

                <f:FormElement>
                    <f:label>
                        <Label 
                            text="{
                                path: '/OBJTYPE',
                                formatter: '.objKeyLabelFormatter'
                            }"
                            required="true">
                            <layoutData>
                                <l:GridData span="L2 M3 S12" linebreak="true" />
                            </layoutData>
                        </Label>
                    </f:label>
                    <Input 
                        id="keyInput"
                        value="{/OBJKEY}"
                        showValueHelp="true"
                        valueHelpOnly="true"
                        valueHelpRequest="onObjectKeyValueHelp">
                        <layoutData>
                            <l:GridData span="L3 M4 S12" />
                        </layoutData>
                    </Input>
                </f:FormElement>
                
                <f:FormElement visible="{= ${/OBJTYPE} === 'OP'}">
                    <f:label>
                        <Label 
                            text="{
                                path: '/OBJTYPE',
                                formatter: '.objSubKeyLabelFormatter'
                            }"
                            required="true">
                            <layoutData>
                                <l:GridData span="L2 M3 S12" linebreak="true" />
                            </layoutData>
                        </Label>
                    </f:label>
                    <Input 
                        id="subkeyInput"
                        enabled="{= ${/OBJKEY} !== undefined &amp;&amp; ${/OBJKEY} !== ''}"
                        value="{/OBJSUBKEY}"
                        showValueHelp="true"
                        valueHelpOnly="true"
                        valueHelpRequest="onObjectSubKeyValueHelp">
                        <layoutData>
                            <l:GridData span="L3 M4 S12" />
                        </layoutData>
                    </Input>
                </f:FormElement>

                <f:FormElement>
                    <f:label>
                        <Label 
                            text="{i18n>Assignment.user}"
                            required="true" >
                            <layoutData>
                                <l:GridData span="L2 M3 S12" linebreak="true" />
                            </layoutData>
                        </Label>
                    </f:label>
                    <Input
                        id="userInput"
                        value="{/PLANTUSER}"
                        showValueHelp="true"
                        valueHelpOnly="true"
                        valueHelpRequest="onUserValueHelp" >
                        <layoutData>
                            <l:GridData span="L3 M4 S12" />
                        </layoutData>
                    </Input>
                </f:FormElement>
            </f:FormContainer>
        </f:Form>

        <footer>
            <Toolbar>
                <ToolbarSpacer />
                <Button text="{i18nGlobal>General.save}" type="Emphasized" press="onSave" />
                <Button text="{i18nGlobal>General.cancel}" press="onCancel" />
            </Toolbar>
        </footer>
    </Page>
</mvc:View>