<c:FragmentDefinition
    xmlns:c="sap.ui.core"
    xmlns:l="sap.ui.layout"
    xmlns:f="sap.ui.layout.form"
    xmlns="sap.m">   
    <f:Form title="{i18nGlobal>General.workorder} {/AUFNR}" editable="true">
        <f:layout>
            <f:ResponsiveGridLayout labelSpanL="2" />
        </f:layout>
        
        <!-- Work Order Details -->
        <f:FormContainer title="{i18n>FormContainer.workorder}">
            <f:layoutData>
                <l:GridData span="L12 M12 S12" />
            </f:layoutData>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18nGlobal>General.plant}"
                        tooltip="{i18nGlobal>General.plant}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text text="{/WERKS}">
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18n>Workorder.type}"
                        tooltip="{i18n>Workorder.type}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text text="{/AUART}">
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18n>Workorder.sysStatus}"
                        tooltip="{i18n>Workorder.sysStatus}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text text="{/SYSTEM_STATUS}">
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18n>Workorder.userStatus}"
                        tooltip="{i18n>Workorder.userStatus}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text text="{/USER_STATUS}">
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18n>Workorder.basicStart}"
                        tooltip="{i18n>Workorder.basicStart}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text
                    text="{
                        path: '/GSTRP',
                        formatter: 'dep.fiori.lib.util.Utilities.date.toShortDate'
                    }" >
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18n>Workorder.basicFinish}"
                        tooltip="{i18n>Workorder.basicFinish}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text
                    text="{
                        path: '/GLTRP',
                        formatter: 'dep.fiori.lib.util.Utilities.date.toShortDate'
                    }" >
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18nGlobal>General.description}"
                        tooltip="{i18nGlobal>General.description}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text text="{/KTEXT}">
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18n>Workorder.pmActType}"
                        tooltip="{i18n>Workorder.pmActType}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text text="{/ILART}">
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18nGlobal>General.longText}"
                        tooltip="{i18nGlobal>General.longText}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" linebreak="true" />
                        </layoutData>
                    </Label>
                </f:label>
                <Input type="Text" value="{/WO_LTXT}" editable="true">
                <layoutData>
                        <l:GridData span="L10 M9 S12" />
                    </layoutData>
                </Input>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18n>Form.workcenterLabel}"
                        tooltip="{i18n>Form.workcenterLabel}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text text="{/VAPLZ}">
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18n>Form.planGroup}"
                        tooltip="{i18n>Form.planGroup}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text
                    text="{/INGPR}"
                    tooltip="{/INGPR}">
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18nGlobal>General.equipment}"
                        tooltip="{i18nGlobal>General.equipment}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text
                    text="{/EQUNR}"
                    tooltip="{/EQUNR}">
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label 
                        text="{i18n>Equipment.equipmentDescriptionLabel}"
                        tooltip="{i18n>Equipment.equipmentDescriptionLabel}" >
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text
                    text="{/EQKTX}"
                    tooltip="{/EQKTX}">
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18n>Form.costCenter}"
                        tooltip="{i18n>Form.costCenter}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" linebreak="true" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text
                    text="{/KOSTL}"
                    tooltip="{/KOSTL}">
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18n>Form.locationLabel}"
                        tooltip="{i18n>Form.locationLabel}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text
                    text="{/TPLNR}"
                    tooltip="{/TPLNR}">
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18nGlobal>General.priority}"
                        tooltip="{i18nGlobal>General.priority}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text text="{/PRIOK}">
                    <layoutData>
                        <l:GridData span="L4 M3 S4" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18n>Form.sysCondition}"
                        tooltip="{i18n>Form.sysCondition}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text text="{/ANLZU}">
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18n>Form.damageCode}"
                        tooltip="{i18n>Form.damageCode}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text text="{/FECOD}">
                    <layoutData>
                        <l:GridData span="L1 M1 S3" />
                    </layoutData>
                </Text>
                <Text text="{/FETXT}">
                    <layoutData>
                        <l:GridData span="L3 M2 S9" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement>
                <f:label>
                    <Label
                        text="{i18n>Form.causeCode}"
                        tooltip="{i18n>Form.causeCode}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text text="{/URCOD}">
                    <layoutData>
                        <l:GridData span="L1 M1 S3" />
                    </layoutData>
                </Text>
                <Text text="{/URTXT}">
                    <layoutData>
                        <l:GridData span="L3 M2 S9" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement visible="{= ${/MSAUS} === 'X' }">
                <f:label>
                    <Label
                        text="{i18n>Form.malfunctionStart}"
                        tooltip="{i18n>Form.malfunctionStart}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text
                    text="{
                        path: '/AUSVN',
                        formatter: 'dep.fiori.lib.util.Utilities.date.toShortDate'
                    }">
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
            <f:FormElement visible="{= ${/MSAUS} === 'X' }">
                <f:label>
                    <Label
                        text="{i18n>Form.malfunctionEnd}"
                        tooltip="{i18n>Form.malfunctionEnd}">
                        <layoutData>
                            <l:GridData span="L2 M3 S12" />
                        </layoutData>
                    </Label>
                </f:label>
                <Text
                    text="{
                        path: '/AUSBS',
                        formatter: 'dep.fiori.lib.util.Utilities.date.toShortDate'
                    }">
                    <layoutData>
                        <l:GridData span="L4 M3 S12" />
                    </layoutData>
                </Text>
            </f:FormElement>
        </f:FormContainer>
        
        <!-- Work Order Operations -->
        <f:FormContainer title="{= ${i18n>Detail.operations} + ' (' + (${/operations/length} || 0) + ')' }">
            <f:layoutData>
                <l:GridData span="L12 M12 S12" />
            </f:layoutData>
            <f:FormElement>
                <VBox items="{/operations}">
                    <f:Form>
                        <f:title>
                            <c:Title text="{i18nGlobal>General.operation} {VORNR}" level="H5" />
                        </f:title>
                        <f:layout>
                            <f:ResponsiveGridLayout labelSpanL="2" />
                        </f:layout>
                        
                        <!-- Operation Details -->
                        <f:FormContainer>
                            <f:layoutData>
                                <l:GridData span="L12 M12 S12" />
                            </f:layoutData>
                            <f:FormElement>
                                <f:label>
                                    <Label text="{i18n>Operations.workCenter}">
                                        <layoutData>
                                            <l:GridData span="L2 M3 S12" />
                                        </layoutData>
                                    </Label>
                                </f:label>
                                <Text text="{ARBPL}">
                                    <layoutData>
                                        <l:GridData span="L4 M3 S12" />
                                    </layoutData>
                                </Text>
                            </f:FormElement>
                            <f:FormElement>
                                <f:label>
                                    <Label text="{i18n>Operations.controlKey}">
                                        <layoutData>
                                            <l:GridData span="L2 M3 S12" />
                                        </layoutData>
                                    </Label>
                                </f:label>
                                <Text text="{STEUS}">
                                    <layoutData>
                                        <l:GridData span="L4 M3 S12" />
                                    </layoutData>
                                </Text>
                            </f:FormElement>
                            <f:FormElement>
                                <f:label>
                                    <Label text="{i18nGlobal>General.description}">
                                        <layoutData>
                                            <l:GridData span="L2 M3 S12" />
                                        </layoutData>
                                    </Label>
                                </f:label>
                                 <Input type="Text" value="{LTXA1}" maxLength="40">
                                    <layoutData>
                                        <l:GridData span="L10 M9 S12" />
                                    </layoutData>
                                    </Input>
                            </f:FormElement>
                            <f:FormElement>
                                <f:label>
                                    <Label text="{i18n>Operations.plannedHours}">
                                        <layoutData>
                                            <l:GridData span="L2 M3 S12" />
                                        </layoutData>
                                    </Label>
                                </f:label>
                                <Text text="{ARBEI}">
                                    <layoutData>
                                        <l:GridData span="L4 M3 S12" />
                                    </layoutData>
                                </Text>
                            </f:FormElement>
                            <f:FormElement>
                                <f:label>
                                    <Label text="{i18n>Operations.numberOfWorkers}">
                                        <layoutData>
                                            <l:GridData span="L2 M3 S12" />
                                        </layoutData>
                                    </Label>
                                </f:label>
                                <Text text="{ANZZL}">
                                    <layoutData>
                                        <l:GridData span="L4 M3 S12" />
                                    </layoutData>
                                </Text>
                            </f:FormElement>
                            <f:FormElement visible="{= ${STEUS} === 'EXT2' }">
                                <f:label>
                                    <Label text="{i18n>Operations.actualWork}">
                                        <layoutData>
                                            <l:GridData span="L2 M3 S12" />
                                        </layoutData>
                                    </Label>
                                </f:label>
                                <Text text="{ISMNW}">
                                    <layoutData>
                                        <l:GridData span="L4 M3 S12" />
                                    </layoutData>
                                </Text>
                            </f:FormElement>
                            <f:FormElement visible="{= ${STEUS} === 'EXT2' }">
                                <f:label>
                                    <Label text="{i18n>Operations.longText}">
                                        <layoutData>
                                            <l:GridData span="L2 M3 S12" linebreak="true" />
                                        </layoutData>
                                    </Label>
                                </f:label>
                                <Text text="{WO_OPNOTE_LTXT}">
                                    <layoutData>
                                        <l:GridData span="L10 M9 S12" />
                                    </layoutData>
                                </Text>
                            </f:FormElement>
                        </f:FormContainer>
                        
                        <!-- Operation Components -->
                        <f:FormContainer>
                            <f:layoutData>
                                <l:GridData span="L12 M12 S12" />
                            </f:layoutData>
                            <f:title>
                                <c:Title text="{= ${i18n>Detail.components} + ' (' + (${components/length} || 0) + ')' }" level="H6" />
                            </f:title>
                            <f:FormElement>
                                <Table 
                                    noDataText="{i18n>Components.listEmpty}"
                                    items="{
                                        path: 'components/',
                                        templateShareable: 'false'
                                    }">
                                    <columns>
                                        <Column vAlign="Middle">
                                            <Label text="{i18nGlobal>General.component}" />
                                        </Column>
                                        <Column
                                            vAlign="Middle">
                                            <Label text="{i18nGlobal>General.item}" />
                                        </Column>
                                        <Column
                                            vAlign="Middle"
                                            width="30%"
                                            minScreenWidth="Desktop"
                                            demandPopin="true"
                                            popinDisplay="Inline">
                                            <Label text="{i18nGlobal>General.description}" />
                                        </Column>
                                        <Column
                                            vAlign="Middle"
                                            hAlign="Right">
                                            <Label text="{i18n>Components.quantityRequired}" />
                                        </Column>
                                        <Column
                                            vAlign="Middle"
                                            hAlign="Right"
                                            minScreenWidth="Tablet"
                                            demandPopin="true"
                                            popinDisplay="Inline">
                                            <Label text="{i18n>Components.quantityIssued}" />
                                        </Column>
                                        <Column
                                            vAlign="Middle"
                                            minScreenWidth="Tablet"
                                            demandPopin="true"
                                            popinDisplay="Inline">
                                            <Label text="{i18nGlobal>General.unit}" />
                                        </Column>
                                        <Column
                                            vAlign="Middle"
                                            minScreenWidth="Tablet"
                                            demandPopin="true"
                                            popinDisplay="Inline">
                                            <Label text="{i18n>Components.category}" />
                                        </Column>
                                    </columns>
                                    <ColumnListItem>
                                        <Label text="{MATNR}" design="Bold" />
                                        <Label text="{POSNR}" />
                                        <Label text="{= ${MAKTX} || ${POTX1} }" />
                                        <Label text="{BDMNG}" />
                                        <Label text="{ENMNG}" />
                                        <Label text="{MEINS}" />
                                        <Label text="{CATEGORY}" />
                                    </ColumnListItem>
                                </Table>
                            </f:FormElement>
                        </f:FormContainer>
                    </f:Form>
                </VBox>
            </f:FormElement>
        </f:FormContainer>
    </f:Form>
</c:FragmentDefinition>