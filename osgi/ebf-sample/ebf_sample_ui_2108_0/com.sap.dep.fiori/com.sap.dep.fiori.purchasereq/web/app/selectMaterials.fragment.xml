<core:FragmentDefinition xmlns="sap.m"
	xmlns:core="sap.ui.core"
	xmlns:app="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"
	xmlns:mvc="sap.ui.core.mvc"
    xmlns:fb="sap.ui.comp.filterbar"
    xmlns:l="sap.ui.layout"
    xmlns:c="sap.ui.core">
	<Dialog
        id="dialogForMaterialList"
        title="{i18n>Dialog.title}"
        class="dep-fiori"
        stretchOnPhone="true"
        contentHeight="100%"
        contentWidth="100%"
        verticalScrolling="false">
			<Page
                showHeader="false"
                showSubHeader="false"
                enableScrolling="false">
				<VBox
                    fitContainer="true"
                    renderType="Bare">
    				<fb:FilterBar 
    	                id="PR-filter-bar"
    	                header="{i18n>Dialog.filterBarHeader}"
    	                showRestoreButton="false"
    	                advancedMode="false"
    	                showClearButton="true"
    	                showSaveButton="true"
    	                clear="onClear" 
    	                search="onFilter"
    	                filterBarExpanded="false">
    	                <fb:filterItems>
    	                    <fb:FilterItem
    	                        name="point"
    	                        label="{i18n>List.material}">
    	                        <fb:control>
    	                            <Input id="materialFilterInput" type="Text"/>
    	                        </fb:control>
    	                    </fb:FilterItem>
    	                    <fb:FilterItem
    	                        name="description"
    	                        label="{i18n>Dialog.description}" >
    	                        <fb:control>
    	                            <Input id="descFilterInput" type="Text"/>
    	                        </fb:control>
    	                    </fb:FilterItem>
    	                 </fb:filterItems>
    	            </fb:FilterBar>
    	            <Toolbar>
    					<SearchField width="100%" id="searchInput" search="onDialogSearch"/>
    				</Toolbar>
    				<Table 
    	                id="material-table-wrapper"
    	                mode="MultiSelect"
    	                showNoData="false">
    	                <columns>
                        	<Column vAlign="Middle">
    	                        <Text text="{i18n>List.material}"/>
    	                    </Column>
    	                    <Column vAlign="Middle" demandPopin="true" minScreenWidth="Tablet">
    	                    	<Text text="{i18n>Dialog.description}" />
                            </Column>
                            <Column vAlign="Middle" hAlign="Right">
    	                    	<Text text="{i18n>List.stock}"/>
                            </Column>
                            <Column demandPopin="true" minScreenWidth="Tablet" vAlign="Middle"> 
                            	<l:Grid
    								hSpacing="0"
    								vSpacing="0"
    								defaultSpan="L6 M6 S12"
    								width="100%"
    								class="hiddenTitle">
    								<Text text="{i18n>List.min}" class="minTableTitle">
    									<layoutData>
                                            <l:GridData
                                                spanS="12"
                                                spanM="2"
                                                spanL="2"/>
                                        </layoutData>
    								</Text>
    		                    	<Text text="{i18n>List.max}" >
    		                    		<layoutData>
                                            <l:GridData
                                                spanS="12"
                                                spanM="2"
                                                spanL="2"/>
                                        </layoutData>
    		                    	</Text>
    		                    	<Text text="{i18n>List.quantity}" >
    		                    		<layoutData>
                                            <l:GridData
                                                spanS="12"
                                                spanM="2"
                                                spanL="2"/>
                                        </layoutData>
    		                    	</Text>
    		                    	<Text text="{i18n>List.delivery}" >
    		                    		<layoutData>
                                            <l:GridData
                                                spanS="12"
                                                spanM="3"
                                                spanL="3"/>
                                        </layoutData>
    		                    	</Text>
                                    <Text text="{i18n>PR.freightMode}" >
                                        <layoutData>
                                            <l:GridData
                                                spanS="12"
                                                spanM="3"
                                                spanL="3"/>
                                        </layoutData>
                                    </Text>
    	                    	</l:Grid>
                            </Column>
    	                </columns>
    	            </Table>
    	            <ScrollContainer
    	            	vertical="true"
    	                height="100%"
    	                width="100%">
    	                <Table 
    	                    noDataText="{i18n>List.empty}" 
    	                    id="material-table"
    	                    items="{path:'ODATA_MODEL>/Unique_Material'
    	                    		}"
    	                    growing="true"
    	                    mode="MultiSelect"
    	                    growingScrollToLoad="true"
    	                    selectionChange="onItemPressed">
    	                    <columns>
    	                    	<Column width="20%" vAlign="Middle">
    		                        <Text text="{i18n>List.material}" />
    		                    </Column>
    		                    <Column demandPopin="true" minScreenWidth="Tablet" width="auto" vAlign="Middle">
    		                    	<Text text="{i18n>Dialog.description}" />
    	                        </Column>
    	                        <Column width="10%" vAlign="Middle" hAlign="Right">
    		                    	<Text text="{i18n>List.stock}"/>
    	                        </Column>
    	                        <Column demandPopin="true" minScreenWidth="Tablet" width="auto" vAlign="Middle">
                            	</Column>
    		                </columns>
    	                    <items>
    	                        <ColumnListItem>
    	                            <cells>
	                            		<HBox alignItems="Center" renderType="Bare">
	                                		<Label text="{ODATA_MODEL>MATNR}"
	                                			class="materialLabelBlue purchaseReqLabelBlue sapUiTinyMarginTop materialLabel" design="Bold" />
                                            <core:Icon src="sap-icon://message-warning"
                                                color="#de890d" 
                                                class="warningSymbol"
                                                visible="{parts: [ 'ODATA_MODEL>MATNR', 'FRONT_END_ERROR>/', 'BACK_END_ERROR>/'], formatter: '.WarningFormatter'}" />
	                                		<core:Icon src="sap-icon://message-error"
	                                			color="#dc0d0e" 
	                                			class="errorSymbol"
	                                			visible="{parts: [ 'ODATA_MODEL>MATNR', 'FRONT_END_ERROR>/', 'BACK_END_ERROR>/'], formatter: '.ErrorFormatter'}" />
		                                </HBox>
		                                <Label text="{ODATA_MODEL>MAKTX}" class="descriptionForMaterial" 
		                                	design="Bold"/>
	                            		<Label class="stockOnHand" 
                                            text="{parts: [ 'ODATA_MODEL>MATNR', 'SELECTED>/' ], formatter: '.StockOnHandFormatter'}" 
	                            			design="Bold"/>
	                            		<l:Grid
											class="gridForHidingElements"
											hSpacing="0"
											vSpacing="0"
											defaultSpan="L6 M6 S12"
											width="100%"
                                            visible="{parts: [ 'ODATA_MODEL>MATNR', 'SELECTED>/' ], formatter: '.visibilityFormatter'}">
											<l:content>
												<Label text="{i18n>Dialog.min}">
			                            			<layoutData>
														<l:GridData
															visibleS="true"
															visibleM="false"
															visibleL="false"
															visibleXL="false"/>
													</layoutData>
												</Label>
												<Text text="{ODATA_MODEL>BSTMI}" class="minListItem">
													<layoutData>
														<l:GridData
																spanS="7"
																spanM="2"
																spanL="2"/>
													</layoutData>
												</Text>

												<Label text="{i18n>Dialog.max}">
			                            			<layoutData>
														<l:GridData
															visibleS="true"
															visibleM="false"
															visibleL="false"
															visibleXL="false"/>
													</layoutData>
												</Label>
												<Text text="{ODATA_MODEL>BSTMA}" class="maxListItem">
													<layoutData>
														<l:GridData
																spanS="7"
																spanM="2"
																spanL="2"/>
													</layoutData>
												</Text>

			                            		<Label text="{i18n>Dialog.qtyAbbr}">
			                            			<layoutData>
														<l:GridData
															visibleS="true"
															visibleM="false"
															visibleL="false"
															visibleXL="false"/>
													</layoutData>
												</Label>
				                                <Input
                                                    type="Number"
                                                    textAlign="Right"
                                                    class="materialReqQuantity">
                                                    <layoutData>
	                                                    <l:GridData
																spanS="3"
																spanM="2"
																spanL="2"/>
													</layoutData>
                                                </Input>
				                                <Label text="{i18n>Dialog.date}">
				                                	<layoutData>
														<l:GridData
															visibleS="true"
															visibleM="false"
															visibleL="false"
															visibleXL="false"/>
													</layoutData>
				                                </Label>
				                                <DatePicker
				                                	placeholder="{i18n>Dialog.enterDate}"
                                                    class="materialDeliveryByDate"
			                                        valueFormat="yyyyMMdd"
			                                        value="{ path: 'SELECTED>/', formatter: 'dep.fiori.lib.util.Utilities.date.currDateFormatted'}"
                                                    minDate="{path: 'SELECTED>/', formatter: 'dep.fiori.lib.util.Utilities.date.currDateNoTime'}">
			                                        <layoutData>
														<l:GridData
															spanS="7"
															spanM="3"
															spanL="3"/>
													</layoutData>
			                                    </DatePicker>
                                                <Label text="{i18n>PR.freightMode}">
                                                    <layoutData>
                                                        <l:GridData 
                                                            visibleS="true"
                                                            visibleM="false"
                                                            visibleL="false"
                                                            visibleXL="false" />
                                                    </layoutData>
                                                </Label>
                                                <Select
                                                    items="{
                                                        path: 'lookup>/freightMode',
                                                        templateShareable: 'false'
                                                    }"
                                                    selectedKey="{ODATA_MODEL>FREIGHT_MODE}"
                                                    showSecondaryValues="true"
                                                    forceSelection="false">
                                                    <c:ListItem text="{lookup>FREIGHT_DESC}" key="{lookup>FREIGHT_MODE}" additionalText="{lookup>FREIGHT_MODE}" />
                                                    <layoutData>
                                                        <l:GridData
                                                            spanS="7"
                                                            spanM="3"
                                                            spanL="3"/>
                                                    </layoutData>
                                                </Select>
		                                    </l:content>
                                        </l:Grid>
    	                            </cells>
    	                        </ColumnListItem>
    	                    </items>
    	                </Table>
    	            </ScrollContainer>
    	        </VBox>
	            <footer>
	            <Bar id="otbFooter" class="footerBar">
		            <contentLeft>
		                <Button
		                    id="dialog-messages-button"
		                    icon="sap-icon://message-popup"
		                    text="{/length}"
		                    type="Emphasized"
		                    press="handleDialogMessagePopoverPress"/>
		            </contentLeft>
		            <contentRight>
		                <Button
		                    id="save-button"
		                    text="{i18nGlobal>General.ok}"
		                    press="materialDialogSave"
		                    enabled="true">
		                </Button>
		                <Button
		                    id="cancel-button"
		                    text="{i18nGlobal>General.cancel}"
		                    press="materialDialogCancel"
		                    enabled="true">
		                </Button>
		            </contentRight>
		        </Bar>
		    </footer>
		</Page>
	</Dialog>
</core:FragmentDefinition>
