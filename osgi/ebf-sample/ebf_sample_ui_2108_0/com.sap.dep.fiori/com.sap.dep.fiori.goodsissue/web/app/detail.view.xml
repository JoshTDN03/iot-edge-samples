<mvc:View
    controllerName="dep.fiori.goodsissue.app.detail"
    class="dep-fiori"
    displayBlock="true"
    height="100%"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:fb="sap.ui.comp.filterbar"
    xmlns:c="sap.ui.core"
    xmlns:u="sap.uxap"
    xmlns:l="sap.ui.layout"
    xmlns="sap.m">
    <Page
        showHeader="false"
        showSubHeader="false"
        enableScrolling="false">
        <u:ObjectPageLayout
            id="content"
            alwaysShowContentHeader="true">

            <u:headerTitle>
                <u:ObjectPageHeader objectTitle="{i18nGlobal>General.workorder} {workorder>/AUFNR}" />
            </u:headerTitle>

            <u:headerContent>
                <l:VerticalLayout width="100%">
                    <HBox
                        fitContainer="true"
                        renderType="Bare"
                        alignItems="Center">
                        <Label
                            text="{i18n>Component.storageLocation}:"
                            class="sapUiTinyMarginEnd" />
                        <Select
                            items="{locations>/}"
                            selectedKey="{selectedLocation>/LGORT}"
                            change="onLocationChange">
                            <c:Item
                                text="{locations>LGORT}"
                                key="{locations>LGORT}" />
                        </Select>
                    </HBox>
                </l:VerticalLayout>
            </u:headerContent>

            <u:sections>
                <u:ObjectPageSection title="{i18n>Workorder.components}">
                    <u:subSections>
                        <u:ObjectPageSubSection>
                            <u:blocks>
                                <ScrollContainer
                                    vertical="true"
                                    height="100%"
                                    width="100%">
                                    <Table
                                        noDataText="{i18n>List.empty}"
                                        growing="true"
                                        items="{components>/}"
                                        growingScrollToLoad="true">
                                        <headerToolbar>
                                            <Toolbar>
                                                <Title text="{i18nGlobal>General.items} ({components>/length})" />
                                                <ToolbarSpacer />
                                                <Button
                                                    tooltip="{i18nGlobal>General.listRefresh}"
                                                    icon="sap-icon://refresh"
                                                    press="refresh" />
                                            </Toolbar>
                                        </headerToolbar>
                                        <columns>
                                            <Column vAlign="Middle">
                                                <Text
                                                    text="{i18nGlobal>General.material}"
                                                    tooltip="{i18nGlobal>General.material}" />
                                            </Column>
                                            <Column vAlign="Middle">
                                                <Text
                                                    text="{i18nGlobal>General.description}"
                                                    tooltip="{i18nGlobal>General.description}" />
                                            </Column>
                                            <Column
                                                vAlign="Middle"
                                                demandPopin="true"
                                                minScreenWidth="Tablet"
                                                popinDisplay="Inline">
                                                <Text
                                                    text="{i18n>Component.bin}"
                                                    tooltip="{i18n>Component.bin}" />
                                            </Column>
                                            <Column
                                                vAlign="Middle"
                                                demandPopin="true"
                                                minScreenWidth="Desktop"
                                                popinDisplay="Inline">
                                                <Text
                                                    text="{i18n>Component.quantityReqd}"
                                                    tooltip="{i18n>Component.quantityReqd}" />
                                            </Column>
                                            <Column
                                                vAlign="Middle"
                                                demandPopin="true"
                                                minScreenWidth="Desktop"
                                                popinDisplay="Inline">
                                                <Text
                                                    text="{i18n>Component.inStock}"
                                                    tooltip="{i18n>Component.inStock}" />
                                            </Column>
                                            <Column
                                                vAlign="Middle"
                                                demandPopin="true"
                                                minScreenWidth="Desktop"
                                                popinDisplay="Inline">
                                                <Text
                                                    text="{i18n>Component.totalQuantityIssued}"
                                                    tooltip="{i18n>Component.totalQuantityIssued}" />
                                            </Column>
                                            <Column
                                                vAlign="Middle"
                                                demandPopin="true"
                                                minScreenWidth="Desktop"
                                                popinDisplay="Inline">
                                                <Text
                                                    text="{i18n>Component.locked}"
                                                    tooltip="{i18n>Component.locked}" />
                                            </Column>
                                            <Column vAlign="Middle">
                                                <Text
                                                    text="{i18n>Component.issueQuantity}"
                                                    tooltip="{i18n>Component.issueQuantity}" />
                                            </Column>
                                        </columns>
                                        <ColumnListItem>
                                            <Text
                                                text="{components>MATNR}"
                                                tooltip="{components>MATNR}" />
                                            <Text
                                                text="{components>MAKTX}"
                                                tooltip="{components>MAKTX}" />
                                            <Text text="{components>LGPBE}" />
                                            <Text text="{components>BDMNG}" />
                                            <Text text="{components>QUANT}" />
                                            <Text text="{components>ENMNG}" />
                                            <Text text="{components>SPERR}" />
                                            <Input
                                                value="{components>ERFMG}"
                                                placeholder="0"
                                                type="Number"
                                                textAlign="Right"
                                                change="onQuantityChange"
                                                valueState="{
                                                    path: 'components>error',
                                                    formatter: '.valueStateFormatter'
                                                }"
                                                valueStateText="{components>error}" />
                                        </ColumnListItem>
                                    </Table>
                                </ScrollContainer>
                            </u:blocks>
                        </u:ObjectPageSubSection>
                    </u:subSections>
                </u:ObjectPageSection>
            </u:sections>
        </u:ObjectPageLayout>

        <footer>
            <Bar>
                <contentRight>
                    <Button
                        type="Emphasized"
                        text="{i18n>Footer.issueGoods}"
                        press="onIssueGoods"/>
                    <Button
                        text="{i18nGlobal>General.cancel}"
                        press="onCancel"/>
                </contentRight>
            </Bar>
        </footer>
    </Page>
</mvc:View>