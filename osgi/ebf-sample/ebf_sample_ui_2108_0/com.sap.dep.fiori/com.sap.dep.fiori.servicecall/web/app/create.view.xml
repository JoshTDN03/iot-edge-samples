<mvc:View controllerName="dep.fiori.servicecall.app.create"
    class="dep-fiori" displayBlock="true" height="100%"
    xmlns:mvc="sap.ui.core.mvc" xmlns:u="sap.uxap" xmlns:l="sap.ui.layout"
    xmlns:f="sap.ui.layout.form" xmlns:c="sap.ui.core" xmlns="sap.m">
    <Page
        showHeader="false"
        showSubHeader="false"
        enableScrolling="false">
        <u:ObjectPageLayout useIconTabBar="true">
            <u:headerTitle>
                <u:ObjectPageHeader objectTitle="{i18n>Create.title}"/>
            </u:headerTitle>

        <u:sections>
            <u:ObjectPageSection
                  id="details" 
                  title="{i18n>Detail.details}">
                  <u:subSections>
                      <u:ObjectPageSubSection>
                          <u:blocks>
                              <f:Form editable="true">
                                  <f:layout>
                                      <f:ResponsiveGridLayout labelSpanL="2" />
                                  </f:layout>
                                  <f:toolbar>
                                      <Toolbar class="sapUiTinyMarginBottom">
                                          <Title text="{i18n>Detail.details}" />
                                      </Toolbar>
                                  </f:toolbar>
                                  <f:FormContainer>
                                      <f:layoutData>
                                          <l:GridData span="L12 M12 S12" />
                                      </f:layoutData>
                                      <f:FormElement>
                                          <f:label>
                                              <Label
                                                  text="{i18n>ServiceCall.subject}"
                                                  tooltip="{i18n>ServiceCall.subject}">
                                                  <layoutData>
                                                      <l:GridData span="L2 M3 S12" />
                                                  </layoutData>
                                              </Label>
                                          </f:label>
                                           <Input value="{/SUBJECT}" maxLength="40">
                                              <layoutData>
                                                  <l:GridData span="L3 M3 S12" />
                                              </layoutData>
                                          </Input>
                                      </f:FormElement>
                                      <f:FormElement>
                                          <f:label>
                                              <Label
                                                  text="{i18n>ServiceCall.priority}"
                                                  tooltip="{i18n>ServiceCall.priority}">
                                                  <layoutData>
                                                      <l:GridData span="L2 M3 S12" linebreak="true" />
                                                  </layoutData>
                                              </Label>
                                          </f:label>
                                          <Select
                                          		id = "prioritySelect" 
                                          		items="{priorities>/}"
                                                selectedKey="{/PRIORITY}" forceSelection="true">
                                              <c:Item text="{priorities>NAME}" key="{priorities>NAME}" />
                                              <layoutData>
                                                  <l:GridData span="L3 M3 S12" />
                                              </layoutData>
                                           </Select>
                                      </f:FormElement>
                                      <f:FormElement>
                                          <f:label>
                                              <Label
                                                  text="{i18n>ServiceCall.problemType}"
                                                  tooltip="{i18n>ServiceCall.problemType}">
                                                  <layoutData>
                                                      <l:GridData span="L2 M3 S12" indent="L1" />
                                                  </layoutData>
                                              </Label>
                                          </f:label>
                                          <Select
                                          		id = "problemTypeSelect"
                                          		items="{problemTypes>/}"
                                                selectedKey="{/PROBLEM_TYPE_CODE}" forceSelection="true">
                                              <c:Item text="{problemTypes>NAME}" key="{problemTypes>CODE}" />
                                              <layoutData>
                                                  <l:GridData span="L3 M3 S12" />
                                              </layoutData>
                                           </Select>
                                      </f:FormElement>
                                      <f:FormElement>
                                          <f:label>
                                              <Label
                                                  text="{i18n>ServiceCall.duration}"
                                                  tooltip="{i18n>ServiceCall.duration}">
                                                  <layoutData>
                                                      <l:GridData span="L2 M3 S12" linebreak="true" />
                                                  </layoutData>
                                              </Label>
                                          </f:label>
                                           <Input id="duration" 
                                           		  type="Number"
                                           		  valueStateText="Enter duration"
                                           		  value="{
	                                           		  path : '/DURATION_IN_MINUTES',
	                                           		  type : 'sap.ui.model.type.String',
													  constraints : {
												  	  	minimum : 0
												 	  }
												  }">											     
                                              <layoutData>
                                                  <l:GridData span="L3 M3 S12" />
                                              </layoutData>
                                          </Input>
                                      </f:FormElement>
                                      <f:FormElement>
                                          <f:label>
                                              <Label
                                                  text="{i18n>ServiceCall.contact}"
                                                  tooltip="{i18n>ServiceCall.contact}">
                                                  <layoutData>
                                                      <l:GridData span="L2 M3 S12" indent="L1" />
                                                  </layoutData>
                                              </Label>
                                          </f:label>
                                          <Input 
                                          	   id="contactSelect"
						                       showValueHelp="true"
						                       valueHelpOnly="true"
						                       value="{/CONTACT_NAME}"
						                       class="sapUiSmallMarginBottom"
						                    	valueHelpRequest="oncontactValueHelp">
							                    <layoutData>
							                        <l:GridData span="L3 M3 S12" />
							                    </layoutData> 
						                  </Input>
                                      </f:FormElement>
                                      <f:FormElement>
                                          <f:label>
                                              <Label
                                                  text="{i18n>ServiceCall.startDate}"
                                                  tooltip="{i18n>ServiceCall.startDate}">
                                                  <layoutData>
                                                      <l:GridData span="L2 M3 S12" linebreak="true"/>
                                                  </layoutData>
                                              </Label>
                                          </f:label>
                                          <DateTimePicker
                                                id="startDateTime"
                                                valueFormat="yyyy-MM-ddTHH:mm:ss.SSS"
                                                value="{/EARLIEST_START_DATE_TIME}"
                                                change="handleChange"
                                                class="sapUiSmallMarginBottom">
                                              <layoutData>
                                                    <l:GridData span="L4 M3 S12" />
                                              </layoutData>
                                          </DateTimePicker>
                                      </f:FormElement>
                                      <f:FormElement>
                                          <f:label>
                                              <Label
                                                  text="{i18n>ServiceCall.dueDate}"
                                                  tooltip="{i18n>ServiceCall.dueDate}">
                                                  <layoutData>
                                                      <l:GridData span="L2 M3 S12"/>
                                                  </layoutData>
                                              </Label>
                                          </f:label>
                                          <DateTimePicker 
                                                id="dueDateTime"
                                                valueFormat="yyyy-MM-ddTHH:mm:ss.SSS"
                                                value="{/DUE_DATE_TIME}"
                                                minDate="{
                                                	path:'/EARLIEST_START_DATE'
                                                }"
                                                change="handleChange"
                                                class="sapUiSmallMarginBottom">
                                              <layoutData>
                                                    <l:GridData span="L4 M3 S6" />
                                              </layoutData>
                                          </DateTimePicker>
                                      </f:FormElement>
                                      <f:FormElement>
                                          <f:label>
                                              <Label
                                                  text="{i18n>ServiceCall.remarks}"
                                                  tooltip="{i18n>ServiceCall.remarks}">
                                                  <layoutData>
                                                      <l:GridData span="L2 M3 S12" linebreak="true" />
                                                  </layoutData>
                                              </Label>
                                          </f:label>
                                          <TextArea
                                              value="{/REMARKS}" rows="3">
                                              <layoutData>
                                                  <l:GridData span="L4 M9 S12" />
                                              </layoutData>
                                        </TextArea>
                                      </f:FormElement>
                                      <f:FormElement>
                                          <f:label>
                                              <Label
                                                  text="{i18n>ServiceCall.resolution}"
                                                  tooltip="{i18n>ServiceCall.resolution}">
                                                  <layoutData>
                                                      <l:GridData span="L2 M3 S12"/>
                                                  </layoutData>
                                              </Label>
                                          </f:label>
                                           <TextArea
                                              value="{/RESOLUTION}" rows="3">
                                              <layoutData>
                                                  <l:GridData span="L4 M9 S12" />
                                              </layoutData>
                                        </TextArea>
                                      </f:FormElement>
                                  </f:FormContainer>
                                  <f:FormContainer id="idAddress" title="{i18n>Detail.address}" >
                                        <f:layoutData>
                                            <l:GridData span="L12 M12 S12" />
                                        </f:layoutData>
                                        <f:FormElement>
                                            <f:label>
                                                <Label
                                                    text="{i18n>Address.street}"
                                                    tooltip="{i18n>Address.street}">
                                                    <layoutData>
                                                        <l:GridData span="L2 M3 S12" />
                                                    </layoutData>
                                                </Label>
                                            </f:label>
                                            <Input value="{/address/STREET}" maxLength="40">
                                              <layoutData>
                                                  <l:GridData span="L4 M3 S12" />
                                              </layoutData>
                                            </Input>
                                        </f:FormElement>
                                        <f:FormElement>
                                            <f:label>
                                                <Label
                                                    text="{i18n>Address.streetNumber}"
                                                    tooltip="{i18n>Address.streetNumber}">
                                                    <layoutData>
                                                        <l:GridData span="L2 M3 S12" />
                                                    </layoutData>
                                                </Label>
                                            </f:label>
                                            <Input value="{/address/STREET_NUMBER}" maxLength="40">
                                              <layoutData>
                                                  <l:GridData span="L4 M3 S12" />
                                              </layoutData>
                                            </Input>
                                        </f:FormElement>
                                        <f:FormElement>
                                            <f:label>
                                                <Label
                                                    text="{i18n>Address.city}"
                                                    tooltip="{i18n>Address.city}">
                                                    <layoutData>
                                                        <l:GridData span="L2 M3 S12" />
                                                    </layoutData>
                                                </Label>
                                            </f:label>
                                            <Input value="{/address/CITY}" maxLength="40">
                                              <layoutData>
                                                  <l:GridData span="L4 M3 S12" />
                                              </layoutData>
                                            </Input>
                                        </f:FormElement>
                                        <f:FormElement>
                                            <f:label>
                                                <Label
                                                    text="{i18n>Address.state}"
                                                    tooltip="{i18n>Address.state}">
                                                    <layoutData>
                                                        <l:GridData span="L2 M3 S12" />
                                                    </layoutData>
                                                </Label>
                                            </f:label>
                                            <Input value="{/address/STATE}" maxLength="40">
                                              <layoutData>
                                                  <l:GridData span="L4 M3 S12" />
                                              </layoutData>
                                            </Input>
                                        </f:FormElement>
                                        <f:FormElement>
                                            <f:label>
                                                <Label
                                                    text="{i18n>Address.country}"
                                                    tooltip="{i18n>Address.country}">
                                                    <layoutData>
                                                        <l:GridData span="L2 M3 S12" />
                                                    </layoutData>
                                                </Label>
                                            </f:label>
                                            <Input value="{/address/COUNTRY}" maxLength="2" minLength="2">
                                              <layoutData>
                                                  <l:GridData span="L4 M3 S12" />
                                              </layoutData>
                                            </Input>
                                        </f:FormElement>
                                        <f:FormElement>
                                            <f:label>
                                                <Label
                                                    text="{i18n>Address.zipCode}"
                                                    tooltip="{i18n>Address.zipCode}">
                                                    <layoutData>
                                                        <l:GridData span="L2 M3 S12" />
                                                    </layoutData>
                                                </Label>
                                            </f:label>
                                            <Input value="{/address/ZIP_CODE}" maxLength="40">
                                              <layoutData>
                                                  <l:GridData span="L4 M3 S12" />
                                              </layoutData>
                                            </Input>
                                        </f:FormElement>
                                    </f:FormContainer>
                                    <f:FormContainer title="{i18n>Create.source}" >
                                        <f:layoutData>
                                            <l:GridData span="L12 M12 S12" />
                                        </f:layoutData>
                                        <f:FormElement>
                                            <f:label>
                                                <Label
                                                    text="{i18n>Source.deviceId}"
                                                    tooltip="{i18n>Source.deviceId}">
                                                    <layoutData>
                                                        <l:GridData span="L2 M3 S12" />
                                                    </layoutData>
                                                </Label>
                                            </f:label>
                                            <Input value="{/DEVICE_ID}">
                                              <layoutData>
                                                  <l:GridData span="L3 M3 S12" />
                                              </layoutData>
                                            </Input>
                                        </f:FormElement>
                                    </f:FormContainer>
                                    <f:FormContainer>
                                        <f:layoutData>
                                            <l:GridData span="L12 M12 S12" />
                                        </f:layoutData>
                                       <f:FormElement>
                                            <Table
                                                noDataText="{i18nGlobal>General.listEmpty}"
                                                growing="true"
                                                growingScrollToLoad="true"
                                                mode="Delete"
                                                items="{/equipments}"
                                                delete="onRemoveEquipment">
                                                <headerToolbar>
                                                    <Toolbar>
                                                        <Title text="{i18nGlobal>General.equipment} ({/equipments/length})" />
                                                        <ToolbarSpacer></ToolbarSpacer>
                                                        <Button
                                                            id="equipmentAdd"
                                                            tooltip="{i18n>Tooltip.addEquipment}"
                                                            icon="sap-icon://add"
                                                            press="onEquipmentPress" />
                                                    </Toolbar>
                                                </headerToolbar>
                                                <columns>
                                                    <Column vAlign="Middle">
                                                        <Label text="{i18n>Equipment.name}" />
                                                    </Column>
                                                    <Column vAlign="Middle">
                                                        <Label text="{i18n>Equipment.serialNumber}" />
                                                    </Column>
                                                    <Column 
                                                        vAlign="Middle"
                                                        minScreenWidth="Tablet"
                                                        demandPopin="true"
                                                        popinDisplay="Inline">
                                                        <Label text="{i18n>Equipment.status}" />
                                                    </Column>
                                                    <Column 
                                                        vAlign="Middle"
                                                        minScreenWidth="Tablet"
                                                        demandPopin="true"
                                                        popinDisplay="Inline">
                                                        <Label text="{i18n>Equipment.type}" />
                                                    </Column>
                                                </columns>
                                                <items>
                                                  <ColumnListItem vAlign="Middle" >
                                                      <Label text="{NAME}" />
                                                      <Label text="{SERIAL_NUMBER}" />
                                                      <Label text="{STATUS}" />
                                                      <Label text="{TYPE}" />
                                                  </ColumnListItem>
                                                </items>
                                            </Table>
                                       </f:FormElement>
                                    </f:FormContainer>
                                    <f:FormContainer>
                                        <f:layoutData>
                                            <l:GridData span="L12 M12 S12" />
                                        </f:layoutData>
                                        <f:FormElement>
                                            <Table
                                                noDataText="{i18nGlobal>General.listEmpty}"
                                                growing="true"
                                                growingScrollToLoad="true"
                                                mode="Delete"
                                                items="{/responsibles}"
                                                delete="onRemoveResponsibles">
                                                <headerToolbar>
                                                    <Toolbar>
                                                        <Title text="{i18n>ServiceCall.responsibles} ({/responsibles/length})" />
                                                        <ToolbarSpacer></ToolbarSpacer>
                                                        <Button
                                                            id="responsiblesAdd"
                                                            tooltip="{i18n>Tooltip.addResponsibles}"
                                                            icon="sap-icon://add"
                                                            press="onResponsiblePress" />
                                                    </Toolbar>
                                                </headerToolbar>
                                                <columns>
                                                    <Column vAlign="Middle">
                                                        <Label text="{i18n>Responsible.firstName}" />
                                                    </Column>
                                                    <Column vAlign="Middle">
                                                        <Label text="{i18n>Responsible.lastName}" />
                                                    </Column>
                                                    <Column 
                                                        vAlign="Middle"
                                                        minScreenWidth="Tablet"
                                                        demandPopin="true"
                                                        popinDisplay="Inline">
                                                        <Label text="{i18n>Responsible.jobTitle}" />
                                                    </Column>
                                                </columns>
                                                <items>
                                                  <ColumnListItem vAlign="Middle" >
                                                      <Label text="{FIRST_NAME}" />
                                                      <Label text="{LAST_NAME}" />
                                                      <Label text="{JOB_TITLE}" />
                                                  </ColumnListItem>
                                                </items>
                                            </Table>
                                        </f:FormElement>
                                    </f:FormContainer>
                                 </f:Form>
                            </u:blocks>
                        </u:ObjectPageSubSection>
                    </u:subSections>
                </u:ObjectPageSection>
            </u:sections>
        </u:ObjectPageLayout>
        <footer>
            <Toolbar>
                <ToolbarSpacer />
                <Button text="{i18nGlobal>General.save}" type="Emphasized" press="onSave" />
                <Button text="{i18nGlobal>General.cancel}" press="onCancel" />
            </Toolbar>
        </footer>
    </Page>
</mvc:View>