<mvc:View
    controllerName="dep.fiori.assignment.app.list"
    class="dep-fiori"
    displayBlock="true"
    height="100%"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:fb="sap.ui.comp.filterbar"
    xmlns:c="sap.ui.core"
    xmlns="sap.m">
    <Page
        showHeader="false"
        showSubHeader="false"
        enableScrolling="false">
        <VBox
            fitContainer="true"
            renderType="Bare">
            <c:Fragment fragmentName="dep.fiori.lib.frag.filterBar" type="XML" />
            <ScrollContainer
                vertical="true"
                height="100%"
                width="100%">
                <Table
                    id="list"
                    items="{odata>/Task_Assignment}"
                    noDataText="{i18nGlobal>General.listEmpty}"
                    growing="true"
                    growingScrollToLoad="true"
                    mode="{= ${page>/currentUserList} ? 'SingleSelectMaster' : 'Delete' }"
                    itemPress="onListItemSelect"
                    delete="onDelete">
                    <headerToolbar>
                        <Toolbar>
                            <Title text="{i18n>List.title}" />
                            <ToolbarSpacer />
                            <Button
                                tooltip="{i18n>List.createAssignment}"
                                icon="sap-icon://add"
                                visible="{= !${page>/currentUserList} }"
                                press="onCreatePress" />
                            <Button
                                tooltip="{i18nGlobal>General.sortList}"
                                icon="sap-icon://drop-down-list"
                                press="onSortPress" />
                        </Toolbar>
                    </headerToolbar>
                    <columns>
                        <Column
                            vAlign="Middle"
                            minScreenWidth="Tablet"
                            demandPopin="true"
                            popinDisplay="Inline">
                            <Title text="{i18n>Assignment.type}" />
                        </Column>
                        <Column vAlign="Middle">
                            <Title text="{i18n>Assignment.objKeys}" />
                        </Column>
                        <Column
                            vAlign="Middle"
                            visible="{= !${page>/currentUserList} }">
                            <Title text="{i18n>Assignment.user}" />
                        </Column>
                        <Column
                            vAlign="Middle"
                            minScreenWidth="Tablet"
                            demandPopin="true"
                            popinDisplay="Inline">
                            <Title text="{i18n>Assignment.status}" />
                        </Column>
                    </columns>
                    <ColumnListItem type="Navigation" vAlign="Middle">
                        <Label
                            text="{odata>OBJTYPE_TEXT}"
                            tooltip="{odata>OBJTYPE_TEXT}" />
                        <Label
                            text="{
                                parts: ['odata>OBJKEY', 'odata>OBJSUBKEY'],
                                formatter: '.objKeysFormatter'
                            }"
                            tooltip="{
                                parts: ['odata>OBJKEY', 'odata>OBJSUBKEY'],
                                formatter: '.objKeysFormatter'
                            }" />
                        <Label
                            text="{odata>PLANTUSER}"
                            tooltip="{odata>PLANTUSER}" />
                        <HBox>
                            <Select
                                id="statusSelect"
                                items="{
                                    path: 'odata>/Assignment_Status',
                                    templateShareable: 'false'
                                }"
                                selectedKey="{
                                    path: 'odata>STATUS',
                                    mode: 'TwoWay'
                                }"
                                change=".onSelectStatus">
                                <c:Item text="{odata>TEXT}" key="{odata>STATUS}" />
                            </Select>
                            <ToggleButton
                                visible="{= ${page>/currentUserList} }"
                                icon="sap-icon://locked"
                                tooltip="{= ${odata>LOCKED_FOR_MOBILE} ? ${i18n>Lock.releaseMobile} : ${i18n>Lock.acquireMobile} }"
                                pressed="{= ${odata>LOCKED_FOR_MOBILE} }"
                                press=".onToggleLock">
                            </ToggleButton>
                        </HBox>
                    </ColumnListItem>
                </Table>
            </ScrollContainer>
        </VBox>

        <footer>
            <Toolbar>
                <ToolbarSpacer />
                <Button text="{i18nGlobal>General.save}" type="Emphasized" enabled="{page>/pendingChanges}" press="onSave" />
                <Button text="{i18nGlobal>General.cancel}" enabled="{page>/pendingChanges}" press="onCancel" />
            </Toolbar>
        </footer>
    </Page>
</mvc:View>