<mvc:View
    controllerName="dep.fiori.materialdoc.app.detail"
    class="dep-fiori"
    displayBlock="true"
    height="100%"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:c="sap.ui.core"
    xmlns:u="sap.uxap"
    xmlns:l="sap.ui.layout"
    xmlns:f="sap.ui.layout.form"
    xmlns="sap.m">
    <Page
        showHeader="false"
        showSubHeader="false"
        enableScrolling="false">
        <u:ObjectPageLayout
            id="content"
            useIconTabBar="true"
            enableLazyLoading="true">
            <u:headerTitle>
                <u:ObjectPageHeader objectTitle="{i18n>Document.number} {/0/MBLNR}">
                    <u:ObjectPageHeaderActionButton
                        icon="sap-icon://message-error"
                        text="{i18nGlobal>General.hasEdgeErrors}"
                        tooltip="{i18nGlobal>General.hasEdgeErrors}"
                        importance="High"
                        visible="{= !!${/EDGE_ERRORS} }"
                        type="Reject"
                        press="handleResponsivePopoverPress" />
                </u:ObjectPageHeader>
            </u:headerTitle>

            <u:headerContent>
                <VBox
                    fitContainer="true"
                    renderType="Bare">
                    <HBox renderType="Bare">
                        <Label
                            text="{i18n>Document.movementType}:"
                            class="sapUiTinyMarginEnd" />
                        <Label text="{/0/BWART} ({/0/BTEXT})" />
                    </HBox>
                    <HBox
                        renderType="Bare"
                        visible="{= ${/0/BWART} === '343' || ${/0/BWART} === '344' }">
                        <Label
                            text="{i18n>Document.purchaseOrder}:"
                            class="sapUiTinyMarginEnd" />
                        <Label text="{/0/EBELN}" />
                    </HBox>
                    <HBox
                        renderType="Bare"
                        visible="{= ${/0/BWART} === '261' || ${/0/BWART} === '262' }">
                        <Label
                            text="{i18nGlobal>General.workorder}:"
                            class="sapUiTinyMarginEnd" />
                        <Label text="{/0/AUFNR}" />
                    </HBox>
                    <HBox
                        renderType="Bare"
                        visible="{= ${/0/BWART} !== '261' &amp;&amp; ${/0/BWART} !== '262' }">
                        <Label
                            text="{i18n>Document.toPlant}:"
                            class="sapUiTinyMarginEnd" />
                        <Label text="{/0/UMWRK}" />
                    </HBox>
                    <HBox renderType="Bare">
                        <Label
                            text="{i18n>Document.toLoc}:"
                            class="sapUiTinyMarginEnd" />
                        <Label text="{/0/UMLGO}" />
                    </HBox>
                </VBox>
            </u:headerContent>

            <u:ObjectPageSection>
                <u:ObjectPageSubSection>
                    <u:blocks>
                        <VBox
                            fitContainer="true"
                            renderType="Bare">
                            <Table
                                noDataText="{i18n>List.empty}"
                                items="{/}"
                                growing="true"
                                growingScrollToLoad="true">
                                <headerToolbar>
                                    <Toolbar>
                                        <Title text="{= ${i18nGlobal>MaterialSelect.listTitle} + ' (' + (${/length} || 0) + ')' }" />
                                        <ToolbarSpacer />
                                        <HBox alignItems="Center" renderType="Bare">
                                            <Label
                                                text="{i18n>Document.reverseMvmtType}:"
                                                visible="{= ${state>/editing} }"
                                                class="sapUiTinyMarginEnd" />
                                            <Select
                                                id="reverseMvmtTypeSelect"
                                                selectedKey="{BWART>/}"
                                                showSecondaryValues="true"
                                                visible="{= ${state>/editing} }"
                                                items="{movementTypes>/}">
                                                <c:ListItem 
                                                    key="{movementTypes>BWART}"
                                                    text="{movementTypes>BWART}"
                                                    additionalText="{movementTypes>BTEXT}" />
                                            </Select>
                                        </HBox>
                                        <Button
                                            tooltip="{i18nGlobal>General.listRefresh}"
                                            icon="sap-icon://refresh"
                                            press="refresh" />
                                        <Button
                                            text="{i18nGlobal>General.edit}"
                                            press="onTableEdit"
                                            visible="{=
                                                !${state>/editing} &amp;&amp;
                                                (${/0/BWART} === '101' || ${/0/BWART} === '261' || ${/0/BWART} === '343')
                                            }" />
                                        <Button
                                            text="{i18nGlobal>General.save}"
                                            press="onTableSave"
                                            visible="{state>/editing}" />
                                        <Button
                                            text="{i18nGlobal>General.cancel}"
                                            press="onTableCancel"
                                            visible="{state>/editing}" />
                                    </Toolbar>
                                </headerToolbar>
                                <columns>
                                    <Column vAlign="Middle">
                                        <Title text="{i18nGlobal>General.material}" />
                                    </Column>
                                    <Column
                                        vAlign="Middle"
                                        width="30%"
                                        minScreenWidth="Desktop"
                                        demandPopin="true"
                                        popinDisplay="Inline">
                                        <Title text="{i18nGlobal>General.description}" />
                                    </Column>
                                    <Column
                                        vAlign="Middle"
                                        minScreenWidth="Tablet"
                                        demandPopin="true"
                                        popinDisplay="Inline">
                                        <Title text="{i18nGlobal>General.location}" />
                                    </Column>
                                    <Column
                                        vAlign="Middle"
                                        minScreenWidth="Tablet"
                                        demandPopin="true"
                                        popinDisplay="Inline">
                                        <Title text="{i18nGlobal>General.bin}" />
                                    </Column>
                                    <Column
                                        vAlign="Middle"
                                        hAlign="Right"
                                        minScreenWidth="Tablet"
                                        demandPopin="true"
                                        popinDisplay="Inline">
                                        <Title text="{i18nGlobal>General.onhand}" />
                                    </Column>
                                    <Column
                                        vAlign="Middle"
                                        hAlign="Right">
                                        <Title text="{i18n>Document.movementQty}" />
                                    </Column>
                                    <Column
                                        vAlign="Middle"
                                        hAlign="Right">
                                        <Title text="{i18n>Document.reverseQty}" />
                                    </Column>
                                    <Column vAlign="Middle">
                                        <Title text="{i18nGlobal>General.unit}" />
                                    </Column>
                                    <Column
                                        vAlign="Middle"
                                        minScreenWidth="Tablet"
                                        demandPopin="true"
                                        popinDisplay="Inline">
                                        <Title text="{i18n>Document.valuation}" />
                                    </Column>
                                </columns>
                                <ColumnListItem vAlign="Middle">
                                    <HBox
                                        fitContainer="true"
                                        renderType="Bare"
                                        alignItems="Center">
                                        <Label
                                            text="{MATNR}"
                                            tooltip="{MATNR}"
                                            design="Bold"
                                            class="identifierTextBlue sapUiTinyMarginEnd" />
                                        <c:Icon
                                            src="sap-icon://message-error"
                                            size="1.25rem"
                                            color="red"
                                            tooltip="{i18nGlobal>General.hasSyncErrors}"
                                            visible="{= !!${EDGE_ERRORS} }"
                                            press="handleResponsivePopoverPress" />
                                    </HBox>
                                    <Label
                                        text="{MAKTX}"
                                        tooltip="{MAKTX}" />
                                    <Label
                                        text="{LGORT}"
                                        tooltip="{LGORT}" />
                                    <Label
                                        text="{LGPBE}"
                                        tooltip="{LGPBE}" />
                                    <Label text="{QUANT}" />
                                    <Label text="{ERFMG}" />
                                    <Input
                                        type="Number"
                                        value="{
                                            path: 'REVERSE',
                                            type: 'sap.ui.model.type.Integer',
                                            formatOptions: {
                                                emptyString: null
                                            }
                                        }"
                                        editable="{= ${state>/editing} }"
                                        visible="{= ${REVERSIBLE_QTY} > 0 }"
                                        valueState="{= ${REVERSE} > ${REVERSIBLE_QTY} ? 'Error' : 'None' }"
                                        valueStateText="{i18n>Error.reverseExceedsQty}"
                                        placeholder="0"
                                        textAlign="Right" />
                                    <Label
                                        text="{ERFME}"
                                        tooltip="{ERFME}" />
                                    <Label
                                        text="{BWTAR}"
                                        tooltip="{BWTAR}" />
                                </ColumnListItem>
                            </Table>
                        </VBox>
                    </u:blocks>
                </u:ObjectPageSubSection>
            </u:ObjectPageSection>
        </u:ObjectPageLayout>
    </Page>
</mvc:View>